<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Osmond House Points</title>
    <link href="index.css" rel="stylesheet">
</head>
<body>
<main class="center">
    <p style="margin-right: 30px; font-size: 50px">Code</p>
    <label>
        <input type="text" id="code" autocomplete="false" autofocus>
    </label>
    <button id="go" class="icon">
        <svg xmlns="http://www.w3.org/2000/svg" height="48" width="48"><path d="M15.2 43.9 12.4 41.05 29.55 23.9 12.4 6.75 15.2 3.9 35.2 23.9Z"/></svg>
    </button>

    <div id="error" style="color: var(--text-warning)"></div>
</main>
</body>
</html>

<script defer>
    const go = document.getElementById('go');
    const code = document.getElementById('code');
    const error = document.getElementById('error');

    go.onclick = async () => {
        const myCode = code.value;
        const valid = await (await fetch(`./backend/valid-code.php?code=${myCode}`)).text();
        if (valid === '1') {
            localStorage.hpCode = myCode;
            document.location.assign('./student-dashboard');
            return;
        }
        error.innerText = 'Looks like that is an invalid code, sorry!';
    };
</script>